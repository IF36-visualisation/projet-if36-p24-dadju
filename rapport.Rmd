---
title: "Exploration cin√©matographique"
author: "Elo√Øse LAPLANCHE, Laure PENG, Gaudeline Maeva SIMO KAMWA, Belvine YEMDJO YOUMBI"
output:
  prettydoc::html_pretty:
    theme: adapta
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r library}
library(ggplot2)
library(tibble)
library(tidyr)
library(lubridate)
library(dplyr)
library(readr)
library(forcats)
library(prettydoc)
library(stringr)
library(tidyverse)
library(plotly)
```

```{r data}
data <- read_csv("data/movies.csv")
```


# Introduction

üé• Bienvenue dans le projet d'exploration cin√©matographique ! üé•

Une √©tude bas√©e sur la visualisation de donn√©es üìà pour d√©couvrir le dessous des films √† succ√®s ‚≠ê

L'√©quipe üöÄ 

- Elo√Øse LAPLANCHE 

- Laure PENG 

- Gaudeline Maeva SIMO KAMWA 

- Belvine YEMDJO YOUMBI

## Donn√©es

Nous avons choisi d‚Äô√©tudier un dataset regroupant des donn√©es sur les films √† succ√®s. Ce jeu de donn√©es a √©t√© trouv√© sur Kaggle et a √©t√© modifi√© par nos soins pour garder uniquement les features qui nous importent dans cette √©tude. 

Le choix de travailler sur des donn√©es li√©es au monde du cin√©ma r√©sulte de l‚Äôenvie de la part des membres de notre √©quipe de d√©couvrir plus en d√©tail cet univers. Toutes les quatre amatrices de films, ce jeu de donn√©es sera pour nous l‚Äôoccasion de travailler sur un sujet qui nous int√©resse et qui nous intrigue.


- Nombre d‚Äôobservations : 4803

- Nombre de variables : 17

- Source : https://www.kaggle.com/datasets/harshshinde8/movies-csv

- Auteur : Harsh Shinde [üîó](https://www.linkedin.com/in/harshshinde/)

D√©tail des donn√©es : 

| Variable                | Type     | Description                                |
|-------------------------|----------|--------------------------------------------|
| budget                  | `Int`    | Budget global pour r√©aliser le film        |
| genres                  | `String` | Genres associ√©s au film                    |
| keywords                | `String` | Mots-cl√©s repr√©sentant le film             |
| overview                | `String` | Synopsis du film                           |
| popularity              | `Float`  | Popularit√© du film (entre 0 et 876)        |
| production_companies    | `String` | Liste des soci√©t√©s de productions          |
| production_countries    | `String` | Liste des pays de production               |
| release_date            | `Date`   | Date de sortie du film                     |
| revenue                 | `Int`    | Revenus g√©n√©r√©s par le film                |
| runtime                 | `Float`  | Dur√©e du film (en minutes)                 |
| spoken_languages        | `String` | Liste des langues parl√©es dans le film     |
| tagline                 | `String` | ‚ÄúSlogan‚Äù du film                           |
| title                   | `String` | Titre du film                              |
| vote_average            | `Float`  | Moyenne de la note attribu√©e (entre 0 et 10)|
| vote_count              | `Int`    | D√©compte du nombre de votes (entre 0 et 13752)|
| cast                    | `String` | Liste des noms des acteurs du film         |
| director                | `String` | Nom du r√©alisateur du film                 |


On peut relever dans ce dataset plusieurs grands groupes de donn√©es : 

- Les donn√©es de **description du film** (*genres, keywords, overview, tagline, title*)

- Les donn√©es concernant la **r√©alisation du film** (*director, cast, spoken_languages, runtime, release_date, production_countries, production_companies, budget*)

- Les donn√©es sur les **retomb√©es du film** (*popularity, revenue, vote_average, vote_count*)

## Plan d'analyse

Ce dataset √©tant assez riche, nous pouvons √©laborer un plan d‚Äôanalyse selon plusieurs grands axes d‚Äô√©tude :

### Analyse du succ√®s des films

Dans cette partie, on s‚Äôinterrogera sur les facteurs qui pourraient ressortir lorsqu‚Äôun film a du succ√®s. Pour cela, on peut se baser sur nos indicateurs de popularit√© et de note moyenne et les comparer avec d‚Äôautres features comme le genre du film, le r√©alisateur ou le budget. Dans cette partie, il faudra veiller √† bien mettre en regard la note du film avec le nombre de votants, afin de ne pas avoir d'analyse biais√©e par un nombre de votants trop faible sur un film par exemple.

***Attentes :*** On peut supposer que plus le r√©alisateur est connu ou que plus le budget est important, et plus le film sera populaire et obtiendra une bonne note. Nous pensons √©galement que les films d'actions seront sans doute les films avec le plus de succ√®s.

***Exemples de questions :***

**Succ√®s du film :** 

- Quels sont les r√©alisateurs les plus populaires en fonction du genre (ou en fonction du nombre de films r√©alis√©s) ?

- Quel genre de film g√©n√®re le plus de revenus ?

- Est-ce qu‚Äôil y a un lien entre le genre et la popularit√© ?

- Est-ce qu'il y a un lien entre les acteurs et la popularit√© ou la note du film ?
  
**Appr√©ciation du film :**

- Est-ce qu‚Äôil y a un lien entre le budget et la note ?

- Est-ce qu'il y a un lien entre la r√©alisation de plusieurs films du m√™me genre et la note du film ?

- Est ce que la langue originale du film a une influence ?

- Y-a-t-il un lien entre popularit√© et note du film ?


###  Analyse des tendances temporelles
Nous pourrons ici analyser plusieurs features en regard des dates de sortie du film. On pourra ou non constater des √©volutions de genre, de r√©alisateurs ou encore de soci√©t√©s de production en fonction du temps afin de voir si de nouveaux sch√©mas se dessinent. Nos donn√©es vont de 1916 √† 2017, mais nous poss√©dons un nombre de films sup√©rieur √† 100 qu'√† partir de 1993, il faudra donc faire attention lors de l'analyse.

***Attentes :*** On peut supposer que les grosses soci√©t√©s de production perdurent au fil du temps et qu'au contraire, les petites soci√©t√©s laissent place √† d'autres. On pourra aussi v√©rifier s'il existe des pays "√† la mode" sur certaines ann√©es. On s'attend √©galement √† une √©volution du budget des soci√©t√©s dans le temps.

***Exemples de questions :***

- Quels sont les pays qui ont r√©alis√© le plus de films en fonction des ann√©es ?

- Est-ce qu‚Äôil y a une √©volution de la popularit√© des films dans le temps ?

- Est-ce que l'ann√©e de r√©alisation impacte sur le genre du film ?

- Est-ce que le budget a √©volu√© au fil des ann√©es ?

- Est-ce qu‚Äôil y a une √©volution de la dur√©e des films dans le temps ?

- Est-ce que les maisons de production ont vari√© le genre de leurs films au fil du temps ?

### Analyse des mots employ√©s pour d√©crire le film
Ici, on pourrait analyser les features telles que le slogan, le titre, le synopsis et les mots-cl√©s pour trouver des liens et faire ressortir des patterns. On pourra aussi √©valuer si le choix de ces mots a une influence sur l'appr√©ciation ou la note du film. Le traitement de donn√©es textuelles peut √™tre certaines fois d√©licat, il faudra donc veiller √† ce que les techniques de traitement soient appropri√©es et les biais identifi√©s.

***Attentes :*** On pense trouver des mots-cl√©s qui ressortent selon le genre du film. On peut aussi imaginer que selon la compagnie de production ou le r√©alisateur, des mots-cl√©s peuvent √™tre repris dans les films qu'ils produisent, comme une marque de fabrique.

***Exemples de questions :***

- Est-ce qu‚Äôil y a des mots que l‚Äôon retrouve le plus dans le titre selon le genre du film ?

- Quels sont les mots-cl√©s les plus fr√©quents en fonction du genre ?

- Est-ce que certains mots-cl√©s ressortent dans les films de telle ou telle compagnie de production ou pour tel r√©alisateur ? Cela a-t-il un lien avec le pays de production ?

- Est-ce que les mots-cl√©s utilis√©s ont une influence sur l'appr√©ciation ou la note du film ?



# Exploration


### Appr√©ciation du film

Nous allons nous interroger dans un premier temps sur le lien que l'on peut avoir entre la note attribu√©e par les utilisateurs au film et sa popularit√©.
Dans le dataset r√©cup√©r√©, il n'est pas explicit√© clairement √† quoi correspond la popularit√© du film. Nous prenons donc le parti de dire que la popularit√© correspond au volume d'activit√© li√© au film, c'est √† dire si les personnes le regardent, peu importe qu'elles l'appr√©cient ou non.

On s'attend √† ce que plus un film est populaire, et plus sa note moyenne est √©lev√©e. 

Tout d'abord, on effectue une rapide analyse de nos donn√©es pr√©sentes pour ces deux features. Comme il s'agit de variables quantitatives continues, on les pr√©sente √† travers un histogramme.

```{r analyse note}
ggplot(data = data, mapping = aes(x = vote_average)) +
  geom_histogram(bins = 30, fill = "#69b3a2") +
  labs(title = "R√©partition des notes moyennes attribu√©es aux films",
       x = "Note moyenne obtenue",
       y = "Nombre d'occurrences") 
```

Nous constatons que les donn√©es semblent coh√©rentes, except√©es celles qui ont une note moyenne de 0. En effet, il est difficilement concevable de penser qu'un film jug√© par plusieurs personnes se voit attribuer la note moyenne de 0. On peut imaginer qu'il s'agissait de valeurs manquantes mises √† 0 dans le dataset.
Nous prendrons donc le parti, pour la question du lien entre popularit√© et note, de retirer les lignes qui ont une note de 0. On utilise une technique d'extraction sous conditions pour faire cela.

```{r analyse popularit√©}
data_filtered_1 <- subset(data, popularity < 150)

ggplot(data = data_filtered_1, mapping = aes(x = popularity)) +
  geom_histogram(bins = 30, fill = "#69b3a2") +
  labs(title = "R√©partition de la popularit√© attribu√©e aux films",
       x = "Popularit√© attribu√©e",
       y = "Nombre d'occurrences")
```


Ici la popularit√© a √©t√© filtr√©e avec la m√™me technique que pour la note, pour ne s√©lectionner que les films avec un popularit√© inf√©rieure √† 150. En effet, seules 19 valeurs sont au dessus de cette limite que nous nous fixons. La popularit√© moyenne est de `r round(mean(data$popularity[data$popularity < 150]), 1)`.


Pour obtenir un graphique lisible par la suite, nous allons calculer la popularit√© moyenne en fonction de la note moyenne. Pour cela, nous commen√ßons par cr√©er des intervalles de note de 0.5 en 0.5, puis nous dispachons nos donn√©es dans les intervalles correspondant avant de faire la moyenne de la popularit√© pour chaque intervalle. La popularit√© moyenne est donc une variable quantitative continue, et apr√®s modification, la note moyenne devient une variable qualitative ordonn√©e.

Comme on souhaite comparer ces deux √©l√©ments, on r√©alisera un diagramme en barres. Nous ajustons la largeur des barres pour que le graphique soit plus agr√©able √† lire.

```{r comparaison_note_popularite}

intervalles <- seq(0, 10, by = 0.5)

data_grouped <- data %>%
  filter(popularity < 150, vote_average != 0) %>%
  group_by(vote_intervalle = cut(vote_average, breaks = intervalles, right = FALSE)) %>%
  summarize(mean_popularity = mean(popularity))

ggplot(data = data_grouped, aes(x = vote_intervalle, y = mean_popularity)) +
  geom_bar(stat = "identity", fill = "skyblue", width = 0.8) +
   scale_x_discrete(labels = paste0(intervalles, " - ", intervalles + 0.5)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  labs(x = "Note moyenne", y = "Popularit√© moyenne", 
       title = "Popularit√© moyenne par tranche de note de 0.5")
```

**Analyse**

Les r√©sultats obtenus sont conformes avec ce que l'on attendait. En effet, on constate que plus la note est √©lev√©e, et plus la popularit√© augmente. 

En revanche, on voit que pour les notes tr√®s √©lev√©es (8,5+), la popularit√© est proche de 0, ce qui ne semble pas normal de prime abord. Cependant, si l'on recoupe ce graphique avec celui montrant la distribution des notes, on constate que tr√®s peu de r√©ponses sont enregistr√©es pour les intervalles de 0 √† 2,5 et 8,5 √† 10. Ceci explique que la popularit√© moyenne attribu√©e soit aussi basse. Pour r√©soudre ce probl√®me, il faudrait pouvoir collecter plus de donn√©es sur les films qui obtiennent une excellente note (ce qui est par ailleurs rare).


---


Maintenant que nous avons montr√© le lien entre la note et la popularit√© du film, nous allons nous pencher sur l'√©tude de la distribution du buget par tranches de notes. Il est int√©ressant d'essayer de comprendre ce qui peut jouer dans la note qu'attribue un utilisateur √† un film.

Nous nous attendons plut√¥t √† ce qu'un film avec un budget important obtienne une bonne note, m√™me si l'on sait que des films √† faible budget sont aussi capables d'avoir de bonnes notes et inversement.

Commen√ßons par analyser le budget, qui est une variable quantitative continue, √† l'aide d'un histogramme.

```{r analyse budget}
ggplot(data = data, mapping = aes(x = budget)) +
  geom_histogram(bins = 60, fill = "#69b3a2") +
  labs(title = "Analyse de la r√©partition du budget attribu√© aux films",
       x = "Budget attribu√©",
       y = "Nombre d'occurrences")
```

On constate que plus de 1500 films ont un budget de 0, ce qui n'est pas concevable. Nous allons donc exclure ces donn√©es enregistr√©es √† 0 par extraction conditionnelle pour la suite de l'analyse, afin de ne pas fausser les r√©sultats. En effet, un film co√ªte forc√©ment de l'argent pour √™tre r√©alis√©. 

Nous avons √† disposition le budget qui est une variable quantitative continue, et la note que l'on laisse sous la forme de variable qualitative ordonn√©e.

Puisque l'on souhaite faire une distribution, on utilise un boxplot (la moyenne, √† titre indicatif, est repr√©sent√©e par un point bleu). 

Avant de cr√©er ce boxplot, plusieurs pr√©traitements sont n√©cessaires. Outre l'extraction conditionnelle, nous devons aussi cr√©er des intervalles de notes de 1 √† 10 par pas de 1 pour que nous graphique soit plus lisible. Nous r√©partissons ensuite ces donn√©es dans ces tranches avant d'effectuer la distribution.

Pour plus de lisibilit√©, le diagramme suivant est interactif afin de pourvoir zoomer sur certaines parties, et obtenir les valeurs correspondantes. 

```{r comparaison_note_budget}

data_filtered <- data[data$budget != 0 & data$vote_average != 0, ]
intervalles <- seq(0, 10, by = 1)
plot_interactif_1 <- ggplot(data = data_filtered, aes(x = cut(vote_average, breaks = intervalles), y = budget)) +
    geom_boxplot(fill = "skyblue", color = "black", size = 0.3) +  
    stat_summary(fun = "mean", geom = "point", shape = 20, size = 2, color = "darkblue") +
    labs(x = "Note obtenue", y = "Budget du film (en M de $)", title = "Distribution du budget des films en fonction de la note obtenue par tranche de 1") +
    scale_y_continuous(labels = function(x) sprintf("%.1f M", x / 1e6)) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
plotly_plot <- ggplotly(plot_interactif_1, tooltip = c())
plotly_plot

```

**Analyse**

On constate que finalement, ce ne sont pas forc√©ment les films avec le plus gros budget qui obtiennent la meilleure note. 

Les budgets m√©dians les plus √©lev√©s sont pour les notes comprises entre 5 et 7, ce qui signifie qu'il n'existe pas de relation claire entre le budget d'un film et sa note. Un budget plus faible, comme c'est le cas pour la m√©diane des notes de 2 √† 5 et de 7 √† 9, peut donner un tr√®s bon film comme un mauvais film aux yeux des spectateurs. 

Ici, les outliers sont int√©ressants puisque l'on constate que plusieurs tr√®s gros budgets m√®nent √† une note correcte voire tr√®s bonne.On en recense pas d'outliers qui aurait un budget tr√®s important et une note tr√®s basse, ce qui pourrait vouloir dire qu'u budget √©lev√© garantirait en quelques sortes une note acceptable. 

La moyenne est en accord avec les r√©sultats √©voqu√©s apr√®s analyse de la m√©diane, √† savoir que les films avec une note bonne mais pas excellente, on en moyenne le budget le plus √©lev√©.

Les donn√©es des notes 1,2 et 9,10 sont √† relativiser puisque tr√®s peu d'observations sont faites sur ces intervalles. 

On comprend avec cette visualisation que le budget seul ne peut pas expliquer une bonne ou mauvaise note, que d'autres facteurs entrent certainement en jeu. Cependant, lorsqu'un film est en pr√©paration, il faut r√©fl√©chir √† sa rentabilit√©, √† l'√©quilibre financier. M√™me si une bonne note pourrait inciter les personnes √† acheter ou aller voir le film, il est envisageable d'aller au cin√©ma pour voir un film avec beaucoup d'actions ou un gros casting, m√™me si la note n'est pas exceptionnelle par exemple. Dans ce cas, il faudrait nous int√©resser plut√¥t √† la popularit√© du film qu'√† sa note.

---

Maintenant que nous avons analys√© la distribution du budget en fonction de la note, nous allons essayer de comparer le budget et la popularit√©. 

En effet, nous pensons qu'un film avec un gros budget peut √™tre populaire dans l'esprit collectif. Lorsque l'on voit qu'un film s'est vu attribuer un budget cons√©quent, on peut esp√©rer un beau casting, des d√©cors travaill√©s ou encore une animation attractive, et donc √™tre amen√©s √† vouloir visionner ce film. 

On s'attend donc √† ce que plus un film a un gros budget, et plus il soit populaire. 

Comme nous souhaitons faire une comparaison, nous allons r√©aliser un scatter plot. Nous ajustons la transparence des points afin d'√©galement visualiser la densit√© des donn√©es sur certains intervalles. Nous cr√©ons √©galement une courbe de tendance √† titre indicatif. Enfin nous pr√©traitons nos donn√©es en amont pour n'extraire que les individus avec une popularit√© inf√©rieure √† 150 et un budget diff√©rent de 0.

```{r comparaison_popularite_budget_1}
data_filtered_1 <- subset(data, popularity < 150 & budget != 0)

ggplot(data = data_filtered_1, aes(x = budget, y = popularity)) +
  geom_point(colour = "darkorange", size = 3, alpha = 0.4) + 
  geom_smooth(method = "lm", se = FALSE, color = "black", linetype = 2) +
  scale_x_continuous(labels = function(x) x / 1e6) +
  labs(x = "Budget du film (en millions de dollars)", y = "Popularit√©", title = "Popularit√© en fonction du budget des films") +
  theme_gray() 

```

On observe sur cette visualisation une tendance g√©n√©rale o√π plus le budget est important et plus la popularit√© est grande. Comme nous avons beaucoup de donn√©es en dessous de 100M de dollars de budget, il est difficile de bien √©valuer cette partie. 

Pour une approche un peu diff√©rente, nous cr√©ons des tranches de 10M de dollars et nous calculons pour chaque tranche la popularit√© moyenne. 


```{r comparaison_popularite_budget_2}

data_filtered_1 <- subset(data, popularity < 150 & budget != 0)
tranches <- seq(0, max(data_filtered_1$budget), by = 5e6)

data_aggregated <- data_filtered_1 %>%
  mutate(budget_tranche = cut(budget, breaks = tranches)) %>%
  group_by(budget_tranche) %>%
  summarise(mean_popularity = mean(popularity, na.rm = TRUE))

ggplot(data = data_aggregated, aes(x = as.numeric(budget_tranche), y = mean_popularity)) +
  geom_point(colour = "#69b3a2", size = 3) + 
  geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = 2) +
  scale_x_continuous(labels = function(x) x * 5) +
  labs(x = "Budget du film (en millions de dollars)", y = "Popularit√© moyenne", title = "Popularit√© moyenne en fonction du budget des films") +
  theme_gray() 

```


**Analyse**

Ce processus nous permet de mettre encore plus en √©vidence la corr√©lation entre le budget et la popularit√©. Plus le budget est √©lev√©, et plus la popularit√© l'est. 

Nous nous attendions √† ce r√©sultat avant de r√©aliser le graphique. En effet, il est courant qu'un film qui est attendu avec un gros budget soit populaire m√™me si ce n'est pas le film de l'ann√©e. Cela rejoint ce que nous avions pens√© suite √† l'√©tude du lien potentiel entre la note et le budget.  

Dans le budget, on comprend √† la fois la r√©mun√©ration des acteurs, des techniciens, des figurants, des r√©alisateurs, mais aussi tout ce qui touche √† la musique, l'√©clairage, la postproduction, le mat√©riel, la r√©gie, les assurances ou encore les droits artistiques et les actions de promotion. Engager un budget cons√©quent signifie donc tr√®s certainement de s'attendre √† une retomb√©e financi√®re importante. C'est ce que nous allons essayer de voir dans la question suivante. 

---

Nous v√©rifions ce point en commen√ßant d'abord par enlever de notre dataset les budgets ou les revenus qui vallent 0. Ensuite, nous cr√©ons des tranches de 20M pour le budget, et nous calculons pour chaque tranche le revenu moyen. Le revenu moyen est une variable quantitative continue, et apr√®s modification, les tranches de budget deviennent une variable qualitative ordonn√©e.Comme on souhaite comparer ces deux √©l√©ments, on r√©alisera un diagramme en barres annot√© pour plus de lisibilit√©.


```{r comparaison_revenus_budget_3}

data_filtered_1 <- subset(data, budget != 0 & revenue != 0)
tranches <- seq(0, max(data_filtered_1$budget), by = 20e6)

data_aggregated <- data_filtered_1 %>%
  mutate(budget_tranche = cut(budget, breaks = tranches)) %>%
  group_by(budget_tranche) %>%
  summarise(mean_revenue = mean(revenue, na.rm = TRUE))

ggplot(data = data_aggregated, aes(x = as.numeric(budget_tranche), y = mean_revenue)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  geom_text(aes(label = sprintf("%.1f", mean_revenue / 1e6)), vjust = -0.5, size = 3) +
  scale_x_continuous(labels = function(x) x * 20) +
  scale_y_continuous(labels = function(x) x / 1e6) +
  labs(x = "Budget du film (en millions de dollars par tranches de 20M)", y = "Revenus moyen (en millions de dollars)", title = "Revenus moyen en fonction du budget des films par tranche de 20M de $") +
  theme_gray()

```

**Analyse**

Comme pr√©vu, plus le budget du film augmente et plus les revenus augmentent. Le trou observ√© entre 320 et 360M de dollars sur le budget correspond √† un manque de donn√©es poour ces budgets l√†.

On constate √©galement un chiffre anormalement √©lev√© pour les revenus √† 1 123M de dollars. Si l'on se penche un peu plus en d√©tail sur les donn√©es, on constate que pour cette tranche l√†, se trouve le film Avatar sorti en 2009, qualifi√© du "plus gros succ√®s cin√©matographique de tous les temps". Il d√©tient le record de recettes, estim√©es √† 2,7 milliards de dollars. Ce chiffre √©tant tr√®s important, il influe forc√©ment sur la moyenne calcul√©e, d'o√π le pic observ√© pour cette tranche. 

Nous n'avons malheureusement pas le d√©tail des recettes obtenues par pays, ni le d√©tail du budet des films, ce qui aurait pu √™tre int√©ressant pour poursuivre notre analyse et l'approfondir. N√©anmoins, nous avons prouv√© √† travers cette question qu'un budget plus cons√©quent a tendance √† √™tre synonyme de recettes importantes.


---


### Succ√®s du film

Nous allons ensuite nous interroger sur les r√©alisateurs les plus populaires en fonction du genre du film.

Pour cela, on r√©cup√®re tout d'abord les genres des films contenus dans le dataset.

```{r data_director_popularity}
data_dirpop <- data.frame(genre=c(), director=c(), popularity=c())

clean_data <- data %>% 
  select(genres, popularity, director) %>%
  arrange(desc(popularity))

genres_0 <- data %>% select(genres)
genres <- c()
for (i in 1:4803) { 
  genres_split <- unlist(str_split(genres_0[i,], ' '))
  if ("Science" %in% genres_split) {
    genres_split <- genres_split[(genres_split != "Science") & (genres_split != "Fiction")]
    genres_split[length(genres_split)+1] <- "Science Fiction"
    
  }
  genres[i] <- list(genres_split)
}

genre_list <- c()
j <- 1
for (elemt_0 in genres) {
  for (elmt_1 in elemt_0) {
    if ((!(elmt_1 %in% genre_list)) &(!(elmt_1 %in% NA))) {
      genre_list[j] <- elmt_1
      j <- j+1
    }
  }
}

for (genre in genre_list) {
    film_filtered <- clean_data %>%
                      filter(str_detect(genres, genre))
    for (j in 1:3) {
      tabgenre <- genre
      tabdir <- film_filtered$director[j]
      tabpop <- film_filtered$popularity[j]
      data_dirpop <- rbind(data_dirpop, data.frame(genre=tabgenre, 
                                                   director=tabdir, 
                                                   popularity=tabpop))
    }
}

print(genre_list)
```

On obtient ainsi, `r length(genre_list)` genres cin√©matographiques diff√©rents. Comme les donn√©es sont quantitatives continues (popularit√©) ou qualitatives (genre), on les pr√©sente en 3 graphiques en barres circulaires (circular barplot) selon le degr√© de popularit√© des films de chaque genre (grande popularit√©, popularit√© moyenne, faible popularit√©).

```{r data_director_popularity_ordered}
pop_max_by_genre <- c()
i <- 1
for (genree in genre_list) {
  pop_max_by_genre[i] <- max((data_dirpop %>% filter(genre == genree))$popularity)
  i <- i+1
}

data_dirpop1 <- data.frame(genre=c(), director=c(), popularity=c())
data_dirpop2 <- data.frame(genre=c(), director=c(), popularity=c())
data_dirpop3 <- data.frame(genre=c(), director=c(), popularity=c())

j <- 1
for (genre in genre_list) {
  for (k in 1:3) {
    genre_ordered <- genre
    director_ordered <- data_dirpop$director[3*(j-1)+k]
    popularity_ordered <- data_dirpop$popularity[3*(j-1)+k]
      
    if (pop_max_by_genre[j] > 450) {
      data_dirpop1 <- rbind(data_dirpop1, data.frame(genre=genre_ordered, 
                                                     director=director_ordered, 
                                                     popularity=popularity_ordered))
    } else if (pop_max_by_genre[j] > 100) {
      data_dirpop2 <- rbind(data_dirpop2, data.frame(genre=genre_ordered, 
                                                     director=director_ordered, 
                                                     popularity=popularity_ordered))
    } else {
      data_dirpop3 <- rbind(data_dirpop3, data.frame(genre=genre_ordered, 
                                                     director=director_ordered, 
                                                     popularity=popularity_ordered))
    }
  }
    j <- j+1
}
```

```{r graph_director_popularity_by_genre1}
empty_bar <- 2
genre_to_add <- rep(levels(factor(data_dirpop1$genre)), each=empty_bar)
to_add <- data.frame(genre=genre_to_add, director=NA, popularity=NA)

data_dirpop1 <- rbind(data_dirpop1, to_add)
data_dirpop1 <- data_dirpop1 %>% arrange(genre)
data_dirpop1$id <- seq(1, nrow(data_dirpop1))

label_data <- data_dirpop1
number_of_bar <- nrow(label_data)
angle <- 90 - 360 * (label_data$id-0.5) / number_of_bar
label_data$hjust <- ifelse(angle < -90, 1, 0)
label_data$angle <- ifelse(angle < -90, angle+180, angle)

base_data <- data_dirpop1 %>%
  group_by(genre) %>%
  summarize(start=min(id), end=max(id) - empty_bar) %>%
  rowwise() %>%
  mutate(title=mean(c(start, end)))

grid_data <- base_data
grid_data$end <- grid_data$end[c(nrow(grid_data), 1:nrow(grid_data)-1)] + 1
grid_data$start <- grid_data$start - 1
grid_data <- grid_data[-1,]

ggplot(data_dirpop1, aes(x=as.factor(id), y=popularity, fill=genre)) +
  geom_bar(aes(x=as.factor(id), y=popularity, fill=genre), stat="identity", alpha=0.5) +
  
  geom_segment(data=grid_data, aes(x = end, y = 800, xend = start, yend = 800), 
               colour = "grey", alpha=1, size=0.3 , inherit.aes = FALSE ) +
  geom_segment(data=grid_data, aes(x = end, y = 600, xend = start, yend = 600), 
               colour = "grey", alpha=1, size=0.3 , inherit.aes = FALSE ) +
  geom_segment(data=grid_data, aes(x = end, y = 400, xend = start, yend = 400), 
               colour = "grey", alpha=1, size=0.3 , inherit.aes = FALSE ) +
  geom_segment(data=grid_data, aes(x = end, y = 200, xend = start, yend = 200), 
               colour = "grey", alpha=1, size=0.3 , inherit.aes = FALSE ) +
  
  annotate("text", x = rep(max(data_dirpop1$id),4), y = c(200, 400, 600, 800), 
           label = c("200", "400", "600", "800") , color="grey", size=2.8 , 
           angle=0, fontface="bold", hjust=0.9) +
  
  geom_bar(aes(x=as.factor(id), y=popularity, fill=genre), stat="identity", alpha=0.5) +
  ylim(-500, 1300) +
  theme_minimal() + 
  theme(
    legend.position = "none",
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.margin = unit(rep(-1,4), "cm"),
    plot.title = element_text(size=12, face="bold", colour="black", vjust=-15, hjust=0.5)
  ) +
  coord_polar() +
  geom_text(data=label_data, aes(x=id, y=popularity+10, label=director, hjust=hjust), 
            color="black", fontface="bold", alpha=0.6, size=3, angle=label_data$angle, 
            inherit.aes = FALSE) +
  
  geom_segment(data = base_data, aes(x = start, y = -20, xend = end, yend = -20), 
               colour = "gray25", alpha = 0.8, size = 0.3, inherit.aes = FALSE) +
  geom_text(data = base_data, aes(x = title, y = -18, label = genre), colour = "gray10", 
            alpha = 0.8, size = 2.5, fontface="bold", hjust=c(0.3, 1, 1.05, 0.5, 0, -0.1, 0.3), 
            vjust=c(1.7, 1.9, -0.4, -0.9, -0.6, 0, 2.5), inherit.aes = FALSE) +
  labs(title = "R√©alisateurs les plus populaires par genre de film (√† grande popularit√©)")
```

Les genres √† grande popularit√© sont les genres dont les films ont une popularit√© sup√©rieure 450. Ainsi, on retrouve des r√©alisateurs comme Kyle Balda, populaire dans les films d'aventure, d'animation, de com√©die et de famille, ou Christopher Nolan, dans les films d'aventure, de science-fiction et les drames. Cependant, on remarque que la popularit√© de certains r√©alisateurs est la m√™me dans plusieurs genres, car elle d√©coule d'un film ayant plusieurs genres.

```{r graph_director_popularity_by_genre2}
empty_bar <- 2
genre_to_add <- rep(levels(factor(data_dirpop2$genre)), each=empty_bar)
to_add <- data.frame(genre=genre_to_add, director=NA, popularity=NA)

data_dirpop2 <- rbind(data_dirpop2, to_add)
data_dirpop2 <- data_dirpop2 %>% arrange(genre)
data_dirpop2$id <- seq(1, nrow(data_dirpop2))

label_data <- data_dirpop2
number_of_bar <- nrow(label_data)
angle <- 90 - 360 * (label_data$id-0.5) / number_of_bar
label_data$hjust <- ifelse(angle < -90, 1, 0)
label_data$angle <- ifelse(angle < -90, angle+180, angle)

base_data <- data_dirpop2 %>%
  group_by(genre) %>%
  summarize(start=min(id), end=max(id) - empty_bar) %>%
  rowwise() %>%
  mutate(title=mean(c(start, end)))

grid_data <- base_data
grid_data$end <- grid_data$end[c(nrow(grid_data), 1:nrow(grid_data)-1)] + 1
grid_data$start <- grid_data$start - 1
grid_data <- grid_data[-1,]

ggplot(data_dirpop2, aes(x=as.factor(id), y=popularity, fill=genre)) +
  geom_bar(aes(x=as.factor(id), y=popularity, fill=genre), stat="identity", alpha=0.5) +
  
  geom_segment(data=grid_data, aes(x = end, y = 400, xend = start, yend = 400), 
               colour = "grey", alpha=1, size=0.3 , inherit.aes = FALSE ) +
  geom_segment(data=grid_data, aes(x = end, y = 300, xend = start, yend = 300), 
               colour = "grey", alpha=1, size=0.3 , inherit.aes = FALSE ) +
  geom_segment(data=grid_data, aes(x = end, y = 200, xend = start, yend = 200), 
               colour = "grey", alpha=1, size=0.3 , inherit.aes = FALSE ) +
  geom_segment(data=grid_data, aes(x = end, y = 100, xend = start, yend = 100), 
               colour = "grey", alpha=1, size=0.3 , inherit.aes = FALSE ) +
  
  annotate("text", x = rep(max(data_dirpop2$id),4), y = c(100, 200, 300, 400), 
           label = c("100", "200", "300", "400") , color="grey", size=2.8 , angle=0, 
           fontface="bold", hjust=0.8) +
  
  geom_bar(aes(x=as.factor(id), y=popularity, fill=genre), stat="identity", alpha=0.5) +
  ylim(-230, 600) +
  theme_minimal() + 
  theme(
    legend.position = "none",
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.margin = unit(rep(-1,4), "cm"),
    plot.title = element_text(size=12, face="bold", colour="black", vjust=-11, hjust=0.5)
  ) +
  coord_polar() +
  geom_text(data=label_data, aes(x=id, y=popularity+10, label=director, hjust=hjust), 
            color="black", fontface="bold", alpha=0.6, size=3, angle=label_data$angle, 
            inherit.aes = FALSE) +
  
  geom_segment(data = base_data, aes(x = start, y = -5, xend = end, yend = -5), 
               colour = "gray25", alpha = 0.8, size = 0.3, inherit.aes = FALSE) +
  geom_text(data = base_data, aes(x = title, y = -18, label = genre), colour = "gray10", 
            alpha = 0.8, size = 2.7, fontface="bold", hjust=c(0.4, 0.9, 1, 0.8, 0.5, 0.4, 0, 0, 0.5), 
            vjust=c(1.3, 1.2, 0, -0.5, -0.3, -0.9, -0.3, 0.9, 1.6), angle=0, inherit.aes = FALSE) +
  labs(title="R√©alisateurs les plus populaires par genre de film (√† popularit√© moyenne)")
```

Ici, les genres √† popularit√© moyenne sont les genres dont les films ont une popularit√© entre 450 et 100. On retrouve Christopher Nolan, √©galement populaire dans les films √† √©nigme, ou George Miller et Colin Trevorrow, tr√®s populaires dans les thriller.

```{r graph_director_popularity_by_genre3}
empty_bar <- 2
genre_to_add <- rep(levels(factor(data_dirpop3$genre)), each=empty_bar)
to_add <- data.frame(genre=genre_to_add, director=NA, popularity=NA)

data_dirpop3 <- rbind(data_dirpop3, to_add)
data_dirpop3 <- data_dirpop3 %>% arrange(genre)
data_dirpop3$id <- seq(1, nrow(data_dirpop3))

label_data <- data_dirpop3
number_of_bar <- nrow(label_data)
angle <- 90 - 360 * (label_data$id-0.5) / number_of_bar
label_data$hjust <- ifelse(angle < -90, 1, 0)
label_data$angle <- ifelse(angle < -90, angle+180, angle)

base_data <- data_dirpop3 %>%
  group_by(genre) %>%
  summarize(start=min(id), end=max(id) - empty_bar) %>%
  rowwise() %>%
  mutate(title=mean(c(start, end)))
base_data$id <- seq(1, nrow(base_data))

grid_data <- base_data
grid_data$end <- grid_data$end[c(nrow(grid_data), 1:nrow(grid_data)-1)] + 1
grid_data$start <- grid_data$start - 1
grid_data <- grid_data[-1,]

ggplot(data_dirpop3, aes(x=as.factor(id), y=popularity, fill=genre)) +
  geom_bar(aes(x=as.factor(id), y=popularity, fill=genre), stat="identity", alpha=0.5) +

  geom_segment(data=grid_data, aes(x = end, y = 80, xend = start, yend = 80), 
               colour = "grey", alpha=1, size=0.3, inherit.aes = FALSE ) +
  geom_segment(data=grid_data, aes(x = end, y = 60, xend = start, yend = 60), 
               colour = "grey", alpha=1, size=0.3, inherit.aes = FALSE ) +
  geom_segment(data=grid_data, aes(x = end, y = 40, xend = start, yend = 40), 
               colour = "grey", alpha=1, size=0.3, inherit.aes = FALSE ) +
  geom_segment(data=grid_data, aes(x = end, y = 20, xend = start, yend = 20), 
               colour = "grey", alpha=1, size=0.3, inherit.aes = FALSE ) +
  
  annotate("text", x = rep(max(data_dirpop3$id),4), y = c(20, 40, 60, 80), 
           label = c("20", "40", "60", "80") , color="grey", size=3, angle=0, 
           fontface="bold", hjust=1.6) +
  
  geom_bar(aes(x=as.factor(id), y=popularity, fill=genre), stat="identity", alpha=0.5) +
  ylim(-50, 90) +
  theme_minimal() + 
  theme(
    legend.position = "none",
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.margin = unit(rep(-1,4), "cm"),
    plot.title = element_text(size=12, face="bold", colour="black", vjust=-12, hjust=0.5)
  ) +
  coord_polar() +
  geom_text(data=label_data, aes(x=id, y=popularity+10, label=director, hjust=hjust), 
            color="black", fontface="bold", alpha=0.6, size=3, angle=label_data$angle, 
            inherit.aes = FALSE) +
  
  geom_segment(data = base_data, aes(x = start, y = -5, xend = end, yend = -5), 
               colour = "gray25", alpha = 0.8, size = 0.3, inherit.aes = FALSE) +
  geom_text(data = base_data, aes(x = title, y = -18, label = genre), colour = "gray10", 
            alpha = 0.8, size = 3, fontface="bold", hjust=c(0.4, 0.7, 0.5, 0.4, 0.8), 
            vjust=c(0.6, 0.2, 1, 0.8, 0), angle=0, inherit.aes = FALSE) +
  labs(title = "R√©alisateurs les plus populaires par genre de film (√† faible popularit√©)")
```

Enfin, les genres √† faible popularit√© sont les genres dont les films ont une popularit√© inf√©rieure √† 100. Ainsi, on 
remarque Elizabeth Banks, Rob Marshall et Ron Clements, populaires dans les films musicaux, ou Jeff Tremaine dans les films documentaires.

**Analyse**

Les r√©sulats obtenus nous permettent de percevoir les r√©alisateurs les plus populaires par genre cin√©matographique. Ils permettent √©galement de faire une premi√®re d√©duction des genres les plus populaires du dataset. N√©anmoins, on peut remarquer qu'en raison des multiples genres d√©finis pour chaque film, la popularit√© de certains films permet √† leurs r√©alisateurs de se d√©marquer dans plusieurs genres √† la fois. Ainsi, Kyle Balda a d√ª r√©alis√© un film faisant partie des genres Adventure, Animation, Comedy et Family, lui permettant d'√™tre class√© dans plusieurs genres. 
De plus, le dataset ne pr√©sente qu'une partie des films r√©alis√©s entre 1900 et 2020. Ainsi, ces r√©sultats ne concernent que les r√©alisateurs et genres pr√©sents dans ce dataset.


### Analyse des tendances temporelles

Nous examinons l'√©volution de la dur√©e des films au fil du temps dans le but de d√©terminer si elle pr√©sente une tendance croissante ou d√©croissante. √âtant donn√© que la date de sortie et la dur√©e des films sont toutes deux des variables quantitatives continues, et que notre objectif est d'√©tudier une √©volution, l'utilisation du graphique en ligne semble √™tre une approche pertinente pour repr√©senter ces donn√©es.

```{r}
movies <- data
movies$release_date <- as.Date(data$release_date)
movies$year <- format(movies$release_date, "%Y")
year <- movies$year
```

Les donn√©es contenant certaines fois des valeurs manquantes, il est judicieux d'utiliser la dur√©e moyenne des films pour avoir un meilleur graphique.

```{r Calcul de la dur√©e moyenne des films par ann√©e}
average_runtime_by_year <- movies %>%
  group_by(year) %>%
  summarise(average_runtime = mean(runtime, na.rm = TRUE))
average_runtime_by_year <- average_runtime_by_year %>%
  arrange(as.numeric(year))
```

```{r graphique de la dur√©e moyenne des films par ann√©e}
ggplot(average_runtime_by_year, aes(x = as.numeric(year), y = average_runtime)) +
  geom_point()+
  geom_line(stat="identity", color="darkblue")+
  geom_smooth(method = "lm", se = FALSE, color = "blue", linetype = "dashed") +
  labs(x = "Ann√©e ", y = "Dur√©e moyenne des films",title="Evolution de la dur√©e dans le temps") +
  theme_minimal() +
  theme_gray()
```

**Analyse**

Le graphique obtenu r√©v√®le une tendance potentielle dans l'√©volution de la dur√©e moyenne des films, qu'elle soit croissante ou d√©croissante. Avant 1920, la dur√©e moyenne des films semble avoir √©t√© plus √©lev√©e par rapport aux autres ann√©es. Cependant, √† partir de l'an 2000, la dur√©e moyenne semble se stabiliser autour de 110 minutes.
Des anomalies dans le graphique peuvent √™tre observ√©es, ce qui peut √™tre attribu√© √† la pr√©sence de valeurs manquantes dans les donn√©es. De m√™me, on remarque des pics sur ce graphique qui semblent influencer la croissance ou la d√©croissance de la courbe d'√©volution. Ces pics pourraient-ils r√©sulter de donn√©es aberrantes ou de valeurs extr√™mes ?
Quant √† la d√©croissance de la dur√©e moyenne des films dans le temps, montr√©e par la courbe de tendance en pointill√©s, plusieurs facteurs peuvent √™tre en jeu. Il est possible que les pr√©f√©rences du public aient √©volu√©, privil√©giant des films plus courts. Cependant, il est √©galement envisageable que les films contemporains soient structur√©s diff√©remment, peut-√™tre moins d√©taill√©s, ce qui entra√Ænerait une r√©duction de leur dur√©e moyenne.


Pour analyser la distribution de la dur√©e des films dans le temps, nous utiliserons un boxplot. Le calcul de la dur√©e moyenne des films n'est pas n√©cessaire pour ce graphique.

```{r convertir release_date en date}
movies$release_date <- as.Date(movies$release_date)
movies$year <- format(movies$release_date, "%Y")
year <- movies$year
```

```{r Cr√©ation du graphique boxplot interactif}
intervalles <- seq(1900, 2020, by = 5)
plot_interactif_1 <- ggplot(data = data, aes(x = (cut(as.numeric(year), breaks = intervalles)), y = runtime)) +
  geom_boxplot(fill = "skyblue", color = "black", size = 0.3) +  
  labs(x = "Ann√©es (Tranche de 5 ans)", y = "Dur√©e du film (en minutes)", title = "Distribution de la dur√©e des films par tranche de 5 ans") +
  scale_y_continuous(labels = function(x) sprintf("%.1f", x)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
plotly_plot <- ggplotly(plot_interactif_1, tooltip = c())
plotly_plot
```

**Analyse**

Le graphique obtenu offre une vision claire de l'√©volution de la dur√©e des films de 1900 √† 2020, mettant en √©vidence une tendance d√©croissante au fil du temps, confirm√©e √† la fois par la m√©diane et la distribution des valeurs. Cependant, il est important de noter que le graphique montre √©galement des films avec une dur√©e de 0 minutes, ce qui est peu probable et pourrait √™tre attribu√© √† la pr√©sence de valeurs manquantes dans le jeu de donn√©es. De plus, des valeurs extr√™mes au-dessus du troisi√®me quartile (Q3) et en dessous du premier quartile (Q1) sugg√®rent la pr√©sence potentielle de donn√©es aberrantes ou de films qui sortent de la norme. Enfin, il est int√©ressant de noter que certains films ont une dur√©e d'un peu plus de 14 minutes. Il convient de se demander s'il s'agit r√©ellement de longs m√©trages ou de courts m√©trages.

Dans une seconde partie, nous allons chercher √† connaitre l‚Äô√©volution de la popularit√© des films en fonction des ann√©es, car comprendre cette √©volution au fil des ans peut fournir des informations pr√©cieuses sur les tendances de consommation de m√©dias, les pr√©f√©rences du public et les changements culturels.

Attente : On s‚Äôimagine que de nos jours, les films sont plus populaires compar√©s aux ann√©es 1900.

Nous avons utilis√© un geom_line() car nous voulons suivre l'√©volution de cette popularit√© au fil des ann√©es. Les variables utilis√©es, telles que la popularit√© et la date de sortie, sont des variables quantitatives continues. 
Tout d‚Äôabord nous avons effectu√© un premier pr√©traitement qui consistait √† convertir la variable release_date en donn√©es de type Date puis d‚Äôen extraire l‚Äôann√©e. Ensuite, calculer la popularit√© moyenne des films sur tous les ans. Enfin, construire un graphique avec la librairie ggplot2.

```{r}
movies_data <- data
movies_data$release_date <- as.Date(movies_data$release_date)
movies_data$year <- format(movies_data$release_date, "%Y")
year <- movies_data$year

average_popularity_by_year <- movies_data %>%
  group_by(year) %>%
  summarise(average_popularity = mean(popularity, na.rm = TRUE))

average_popularity_by_year <- average_popularity_by_year %>% filter(year < 2017)
```

```{r Cr√©er un graphique de la popularit√© moyenne des films par ann√©e}
ggplot(average_popularity_by_year, aes(x = as.numeric(year), y = average_popularity)) +
  geom_line(stat = 'identity', color="darkblue") +
  geom_smooth(method = "lm", se = FALSE, color = "blue", linetype = "dashed") +
  geom_point() +
  labs(title = "√âvolution de la Popularit√© des Films par Ann√©e",
       x = "Ann√©e",
       y = "Popularit√© Moyenne") +
  theme_minimal() +
  theme_gray() 
```


**Analyse**

On obtient comme une courbe stable entre les ann√©es 1900 ‚Äì 1920, √©tant donn√© que le dataset ne comporte pas assez d‚Äôinformations sur la popularit√© des films sur cette p√©riode. Aussi, on peut constater qu‚Äôavant les ann√©es 1980, les films √©taient plus reconnus compar√© √† nos jours peut-√™tre d√ª au fait qu‚Äôon n‚Äôen produisait pas assez ou qu‚Äôon avait pas une large possibilit√© de choix. On peut le remarquer par la pr√©sence de nombreux pics sur cette p√©riode. Alors qu‚Äôapr√®s les ann√©es 1980, de nombreux pays s‚Äôadh√®rent √† la r√©alisation des films. On pourrait alors parler d‚Äôune forme de concurrence entre ceux-ci. Ceci pouvant s'expliquer par une certaine stabilit√© de la popularit√© des films sur cet intervalle.

Nous allons essayer de comprendre la ou les raisons des pics a certaines p√©riodes donn√©es sur le graphique.

Entre les ann√©es 1925 ‚Äì 1950, on a des pics de popularit√©. En effet, l'industrie cin√©matographique a connu une √©volution significative de genres embl√©matiques tels que le film noir, la com√©die musicale, le western et le screwball comedy. Les studios hollywoodiens ont domin√© l'industrie et ont produit des films caract√©ris√©s par des narrations lin√©aires, des stars de cin√©ma embl√©matiques. 

Puis, Les ann√©es 1950-1970 ont √©t√© marqu√©es par l'√©mergence de mouvements cin√©matographiques comme la Nouvelle Vague fran√ßaise, le cin√©ma d'auteur et le cin√©ma ind√©pendant. Les films ont explor√© des sujets sociaux et politiques, et de nouveaux genres comme le film d'horreur moderne ont vu le jour. 

Ensuite, Les ann√©es 1980 - 1990 ont √©t√© domin√©es par les blockbusters hollywoodiens, avec l'√©mergence de franchises embl√©matiques comme Star Wars, Indiana Jones et Jurassic Park. Les genres populaires comprenaient l'action, la science-fiction et les films pour adolescents. 

Au cours des deux derni√®res d√©cennies, l'industrie cin√©matographique s'est diversifi√©e avec l'√©mergence de nouveaux genres et styles de films. Les films de super-h√©ros sont devenus omnipr√©sents, tandis que le cin√©ma ind√©pendant a continu√© √† prosp√©rer avec des films exp√©rimentaux et innovants. De plus, les avanc√©es technologiques ont permis de nouveaux genres comme les films en 3D et les films d'animation num√©rique.

Pour une meilleure appr√©ciation de la popularit√© des films au cours des ann√©es, nous avons r√©alis√© une distribution de celle ‚Äì ci sur tous les 5 ans afin de savoir s‚Äôil y a eu des films qui ont √©t√© plus populaires que d‚Äôautres sur cet intervalle de temps ou bien s‚Äôil √©tait en moyenne autour de la m√™me valeur.

```{r Extraire ann√©e de la date de sortie}
movies$release_date <- as.Date(movies$release_date)
movies$year <- format(movies$release_date, "%Y")
year<- movies$year
```

```{r Changer ou modifier la dur√©e des tranches et creation du graphique de la distribution de la popularite des films }
intervalles <- seq(1900, 2020, by = 5)
plot_interactif <- ggplot(data = data, aes(x = (cut(as.numeric(year), breaks = intervalles)), y = popularity)) +
  geom_boxplot(fill = "brown", color = "black", size = 0.3) +  
  labs(x = "Ann√©es ", y = "Popularit√© du film", title = "Distribution de la populariit√© des films sur tous les 5 ans") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
plotly_plot <- ggplotly(plot_interactif, tooltip = c())
plotly_plot
```


**Analyse**

Pour l'affichage du graphique, nous n'avons consid√©r√© la popularit√© qu'entre 0 et 250 car ce n'est que dans cet intervalle que les points sont represent√©s. Aussi, cette d√©cision a √©t√© prise afin d'obtenir une meilleure appr√©ciation et lisibilit√© de la popularit√© moyenne des films.

On constate qu‚Äô√† partir de l‚Äôann√©e 1970 jusqu‚Äô√† nos jours, il y a des films qui sont plus populaires que d‚Äôautres avec l'√©mergence de mouvements cin√©matographiques, Les genres populaires comprennent l'action, la science-fiction pour adolescents. Les films de super-h√©ros sont devenus omnipr√©sents et les styles de films en 3D. Alors qu‚Äôavant les ann√©es 1970, nous √©tions dans une certaine suffisance ce qui pourrait justifier la raison pour laquelle il n‚Äôy a pas de films plus populaires que d‚Äôautres au cours de cette p√©riode-l√†.

Cela nous am√®ne √† une nouvelle question qui est de savoir le nombre de films r√©alis√©s par pays chaque ann√©e.

Attente : On s‚Äôattend √† avoir les √âtats-Unis pour avoir r√©alis√© le plus de films chaque ann√©e du fait qu‚Äôils soient tr√®s pr√©sents sur des p√©riodes √©mergentes de la cin√©matographie et √† une hausse de production de films dans les ann√©es 2000.

Pour r√©aliser une comparaison, nous avons utilis√© un geom_bar(). Les variables utilis√©es, telles que la compagnie de production et la date, sont respectivement des variables qualitatives nominales et quantitatives continues. 

Au cours du pr√©traitement, nous avons constat√© la pr√©sence de textes JSON dans la variable de compagnie de production. De ce fait, nous avons cr√©er une fonction pour nettoyer la colonne. Ensuite, nous devons compter le nombre de fois qu‚Äôun pays intervient dans la r√©alisation d‚Äôun film √† une ann√©e donn√©e et le repr√©senter.

```{r Fonction pour nettoyer la colonne en ne gardant que les lettres majuscules}
clean_countries <- function(countries) {
  cleaned <- gsub("[^A-Z]", "", countries)
  return(cleaned)
}
```

```{r S√©parer la liste de fa√ßon propre }
movies_data$production_countries <- gsub("\\[|\\]", "", movies_data$production_countries)
movies_data <- movies_data %>%
  separate_rows(production_countries, sep = ", ") %>%
  filter(production_countries != "")

movies_data$release_date <- as.Date(movies_data$release_date)
movies_data$year <- format(movies_data$release_date, "%Y")
year <- movies_data$year
```

```{r Compter le nombre de films r√©alis√©s par pays de production et par ann√©e }
films_par_pays_par_annee <- movies_data %>%
  group_by(year, production_countries) %>%
  summarise(nombre_de_films = n()) %>%
  ungroup()

films_par_pays_par_annee$production_countries <- sapply(films_par_pays_par_annee$production_countries, clean_countries)

films_par_pays_par_annee <- films_par_pays_par_annee %>%
  group_by(production_countries, year) %>%
  filter(sum(nombre_de_films) > 5)
```

```{r creation du graphique du nombre de films r√©alis√©s par pays et par ann√©e }
plot_interactif <- ggplot(films_par_pays_par_annee, aes(x = as.numeric(year), y = nombre_de_films, fill = production_countries)) +
  geom_bar(stat = "identity") +
  labs(x = "Ann√©e", y = "Nombre de films r√©alis√©s", fill = "Pays", title = " Nombre de films r√©alis√©s par pays et par ann√©e ") +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
plotly_plot <- ggplotly(plot_interactif, tooltip = c())
plotly_plot
```


**Analyse**

On remarque qu‚Äôeffectivement, ce sont les √âtats-Unis qui r√©alisent le plus de films sur les ann√©es. Aussi, on constate que la production des films a doubl√© √† partir de l‚Äôann√©e 1997 et tripl√© √† partir des ann√©es 2000.
Les espaces vides pr√©sents sur le graphique peuvent s‚Äôexpliquer par le manque de valeurs √† ces instants. De plus, le graphique ne repr√©sente que les pays qui ont r√©alis√© plus de 5 films sur une ann√©e donn√©e pour √©viter la surcharge et obtenir une meilleure visibilit√© car avant les ann√©es 1960, les pays producteurs r√©alisaient moins de 5 films par ann√©e.
M√™me si la pr√©pond√©rance des Etats-Unis est notable, il convient de souligner qu'√† partir des ann√©es 2000, les pays producteurs se diversifient.
